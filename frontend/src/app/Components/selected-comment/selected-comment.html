<div class="max-w-2xl mx-auto p-6 bg-white rounded-xl shadow">
  <a [routerLink]="['/']">
    <button class="bg-blue-500 hover:bg-blue-600 text-white px-3 py-1 rounded transition">Home</button>
  </a>
  <div *ngIf="!isLoaded" class="loading-container">
    <div class="spinner"></div>
    <p>Loading...</p>
  </div>
  <div *ngIf="comment$ | async as comment">
    <div *ngIf="comment.parentComment" class="mb-6 p-4 bg-gray-50 rounded-lg border">
      <h2 class="font-semibold mb-2">Parent Comment</h2>
      <a (click)="goToComment(comment.parentComment.id)">
        <app-reply-comment [comment]="comment.parentComment"></app-reply-comment>
      </a>
    </div>

    <div class="mb-6">
      <h2 class="text-lg font-semibold text-gray-800 mb-1">{{ comment.username }}</h2>
      <p class="text-gray-700" [innerHTML]="comment.content"></p>
      <p class="text-sm text-gray-500">{{ comment.createdAt | date:'short' }}</p>
      <button *ngIf="comment.fileType" (click)="download(comment)"
        class="bg-blue-500 hover:bg-blue-600 text-white px-3 py-1 rounded transition">
        Download {{comment.fileType}}
      </button>
    </div>

    <div class="flex-shrink-0 max-w-2xl mx-auto w-full p-6 bg-white border-t border-gray-300">
      <h3 class="font-bold text-lg text-gray-800 mb-3">Reply</h3>
      <app-comment-form [parentCommentId]="comment.id"></app-comment-form>
    </div>

    <div class="mb-6">
      <h3 class="text-md font-semibold text-gray-700 mb-2">Replies</h3>
      <div *ngIf="comment.replies?.length; else noReplies">
        <a *ngFor="let reply of comment.replies" class="border-t py-2" (click)="goToComment(reply.id)">
          <app-reply-comment [comment]="reply"></app-reply-comment>
        </a>
      </div>
      <ng-template #noReplies>
        <p class="text-gray-500 italic">No replies yet</p>
      </ng-template>
    </div>

  </div>
</div>